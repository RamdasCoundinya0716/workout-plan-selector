<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Workout Plan Selector</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; transition: all 0.3s ease; }
    body { background-color: #f4f4f4; color: #333; display: flex; justify-content: center; align-items: center; height: auto; flex-direction: column; padding: 30px 20px; }
    .container { background: #fff; padding: 25px 30px; border-radius: 12px; box-shadow: 0px 4px 12px rgba(0,0,0,0.1); width: 100%; max-width: 480px; text-align: center; }
    h2, h3 { margin-bottom: 12px; font-weight: 600; }
    select, input[type="number"] { padding: 10px; margin-top: 15px; width: 100%; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; }
    .plan-link { margin-top: 20px; }
    .plan-link button, .container button { background-color: #007bff; border: none; padding: 10px 20px; border-radius: 6px; color: white; font-size: 16px; font-weight: 500; cursor: pointer; }
    .container button:hover { background-color: #0056b3; }
    .toggle-btn { margin-top: 16px; background: #333; padding: 6px 12px; border-radius: 5px; cursor: pointer; color: #fff; display: inline-block; }
    .dark-mode { background-color: #222; color: #fff; }
    .dark-mode .container { background: #333; }
    .dark-mode select, .dark-mode input[type="number"] { background: #444; color: #fff; border: 1px solid #666; }
    .dark-mode .plan-link button { background-color: #1d84f7; }
    #tdeeBot { text-align: left; }
    #tdeeBot label { display: block; margin-top: 10px; }
    #tdeeResult { margin-top: 15px; font-size: 15px; line-height: 1.5; }
    .image-caption { font-size: 13px; margin-top: 10px; font-style: italic; }
    img.bodyfat-img { width: 100%; margin-top: 8px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .center-btn { display: flex; justify-content: center; margin-top: 10px; }
    .activity-info { margin-top: 12px; font-size: 13px; color: #555; line-height: 1.4; }
    .dark-mode .activity-info { color: #ccc; }
    #motivationalNote { margin-top: 10px; font-size: 14px; font-style: italic; font-weight: bold; }
    .img-error { margin-top: 8px; font-size: 13px; color: #b00020; display: none; }
  </style>
</head>
<body>
  <div class="container">
    <h2>üèãÔ∏è Workout Plan Selector</h2>
    <p>Select how many days you can hit the gym:</p>

    <select id="daySelector" required>
      <option value="">-- Choose Days --</option>
      <option value="3">3 Days</option>
      <option value="4">4 Days</option>
      <option value="5">5 Days</option>
      <option value="6">6 Days</option>
    </select>

    <div class="plan-link" id="planLink"></div>

    <div class="toggle-btn" onclick="toggleDarkMode()">üåô Toggle Dark Mode</div>
    <div class="toggle-btn" onclick="toggleTDEE()">ü§ñ Not sure about diet? Click here</div>

    <div id="tdeeBot" style="display:none; margin-top:20px;">
      <h3>üß† Nutrition Assistant</h3>

      <label>Weight (kg):
        <input type="number" id="weightInput" required />
      </label>

      <label>Height (cm):
        <input type="number" id="heightInput" required />
      </label>

      <label>Age:
        <input type="number" id="ageInput" required />
      </label>

      <!-- Sex selector -->
      <label>Sex:
        <select id="sexInput" onchange="handleSexChange()" required>
          <option value="">-- Select --</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </label>

      <label>Goal:
        <select id="goalSelector" required>
          <option value="">-- Select --</option>
          <option value="cut">Cut</option>
          <option value="bulk">Bulk</option>
        </select>
      </label>

      <!-- Body fat section (optional), shown for both sexes, image swaps -->
<div id="bfSection" style="display:none">
  <p style="margin-top:12px; font-size:14px; font-weight:500;">
    Please select your body fat percentage approximately based on the below pictures:
  </p>
  <label>Body Fat % (approximately):
    <select id="bodyFatSelect">
      <option value="">-- Not Sure --</option>
      <option value="10">10%</option>
      <option value="15">15%</option>
      <option value="20">20%</option>
      <option value="25">25%</option>
      <option value="30">30%</option>
      <option value="35">35%</option>
      <option value="40">40%</option>
    </select>
  </label>
  <p class="image-caption" id="bfCaption">
    Here's a rough estimate of your body fat % from how your body looks currently:
  </p>
  <img id="bfImage" src="" alt="Body Fat Reference" class="bodyfat-img" loading="lazy" />
  <div id="imgError" class="img-error">Image not found. Please confirm the file exists on the <em>main</em> branch with the exact filename.</div>
</div>

      <label>Activity Level:
        <select id="activityLevel" required>
          <option value="">-- Select --</option>
          <option value="1.2">Sedentary</option>
          <option value="1.375">Lightly Active</option>
          <option value="1.55">Moderately Active</option>
          <option value="1.725">Very Active</option>
          <option value="1.9">Athlete Level</option>
        </select>
      </label>

      <div class="center-btn">
        <button onclick="calculateTDEE()">Calculate TDEE & Protein</button>
      </div>

      <div class="activity-info">
        <p><strong>Sedentary:</strong> Little or no exercise</p>
        <p><strong>Lightly Active:</strong> Light exercise/sports 1‚Äì3 days/week</p>
        <p><strong>Moderately Active:</strong> Moderate exercise 3‚Äì5 days/week</p>
        <p><strong>Very Active:</strong> Hard exercise 6‚Äì7 days/week</p>
        <p><strong>Athlete Level:</strong> Very hard exercise & physical job</p>
      </div>

      <div id="tdeeResult"></div>

      <div id="motivationalNote">
        Note: If you are into the process, stick with it for at least 12 weeks. Do not expect results overnight.
      </div>
    </div>
  </div>

  <script>
    /* Workout plan links */
    const links = {
      3: "https://docs.google.com/document/d/1ju_KcRZ2tpBow59h7Wii5blfRiR_Xuv_XNhnM6NVqmg/edit?usp=drivesdk",
      4: "https://docs.google.com/document/d/11SAeQUFcz4-veLXBgZU3DfEIaswhfT2xf9N87wFeBU8/edit?usp=drivesdk",
      5: "https://docs.google.com/document/d/1IHulCUE-A4mqi513hB-Q67mzOmUA5ac6beB19F3TZME/edit?usp=drivesdk",
      6: "https://docs.google.com/document/d/1_BkkG0QxzsRr0CKM6XnGlzlHTckShEwdfU5e_yzPVFY/edit?usp=drivesdk"
    };

    /* Exact new image filenames on main */
    const GH_BASE = "https://raw.githubusercontent.com/RamdasCoundinya0716/workout-plan-selector/main";
    const MALE_BF_IMG = `${GH_BASE}/malebodyfatimage.jpg`;
    const FEMALE_BF_IMG = `${GH_BASE}/femalebodyfat.jpeg`;

    document.getElementById('daySelector').addEventListener('change', function () {
      const selected = this.value;
      const planLinkDiv = document.getElementById('planLink');
      planLinkDiv.innerHTML = '';

      if (links[selected]) {
        const button = document.createElement('button');
        button.textContent = `Click here for ${selected}-day workout plan`;
        button.onclick = () => window.open(links[selected], '_blank');
        planLinkDiv.appendChild(button);
      }
    });

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    function toggleTDEE() {
      const tdeeBox = document.getElementById('tdeeBot');
      tdeeBox.style.display = tdeeBox.style.display === 'none' ? 'block' : 'none';
    }

    /* Show BF section and swap image based on sex */
    function handleSexChange() {
      const sex = document.getElementById('sexInput').value;
      const bfSection = document.getElementById('bfSection');
      const bfImage = document.getElementById('bfImage');
      const bfCaption = document.getElementById('bfCaption');
      const imgError = document.getElementById('imgError');

      if (!sex) {
        bfSection.style.display = "none";
        bfImage.src = "";
        imgError.style.display = "none";
        return;
      }

      bfSection.style.display = "block";
      imgError.style.display = "none"; // reset

      const src = (sex === "male") ? MALE_BF_IMG : FEMALE_BF_IMG;
      bfCaption.textContent = `Here's a rough estimate of your body fat % (${sex === "male" ? "Male" : "Female"}):`;

      // Add cache-buster to avoid stale 404s
      bfImage.src = `${src}?v=${Date.now()}`;
      bfImage.style.display = "block";
      bfImage.onerror = () => {
        bfImage.style.display = "none";
        imgError.style.display = "block";
      };
    }

    function calculateTDEE() {
      const weight = parseFloat(document.getElementById('weightInput').value);
      const height = parseFloat(document.getElementById('heightInput').value);
      const age = parseInt(document.getElementById('ageInput').value);
      const sex = document.getElementById('sexInput').value;
      const goal = document.getElementById('goalSelector').value;
      const activity = parseFloat(document.getElementById('activityLevel').value);
      const bf = parseFloat(document.getElementById('bodyFatSelect').value);

      if (isNaN(weight) || isNaN(height) || isNaN(age) || isNaN(activity) || sex === "" || goal === "") {
        alert("Please fill in all required fields.");
        return;
      }

      let bmr, leanMass;
      const useBodyFat = goal === 'cut' && !isNaN(bf);

      if (useBodyFat) {
        leanMass = weight * (1 - bf / 100);
        bmr = 370 + (21.6 * leanMass); // Katch‚ÄìMcArdle (gender-neutral)
      } else {
        bmr = 10 * weight + 6.25 * height - 5 * age + (sex === "male" ? 5 : -161); // Mifflin‚ÄìSt Jeor
        leanMass = weight * 0.85; // fallback estimate if BF% not used
      }

      const tdee = bmr * activity;
      const proteinLow = Math.round(1.8 * leanMass);
      const proteinHigh = Math.round(2.2 * leanMass);
      const cutCalories = `${(tdee * 0.8).toFixed(0)} ‚Äì ${(tdee * 0.85).toFixed(0)}`;
      const bulkCalories = `${(tdee * 1.1).toFixed(0)} ‚Äì ${(tdee * 1.2).toFixed(0)}`;

      document.getElementById('tdeeResult').innerHTML = `
        <p><strong>Sex:</strong> ${sex.charAt(0).toUpperCase() + sex.slice(1)}</p>
        <p><strong>Goal:</strong> ${goal.charAt(0).toUpperCase() + goal.slice(1)}</p>
        ${useBodyFat ? `<p><strong>Lean Body Mass:</strong> ${leanMass.toFixed(1)} kg</p>` : ""}
        <p><strong>BMR:</strong> ${bmr.toFixed(0)} kcal/day</p>
        <p><strong>TDEE:</strong> ${tdee.toFixed(0)} kcal/day</p>
        <p><strong>Protein Requirement:</strong> ${proteinLow}g ‚Äì ${proteinHigh}g</p>
        <p><strong>Recommended Calories to ${goal}:</strong> ${goal === 'cut' ? cutCalories : bulkCalories} kcal/day</p>
      `;
    }
  </script>
</body>
</html>
